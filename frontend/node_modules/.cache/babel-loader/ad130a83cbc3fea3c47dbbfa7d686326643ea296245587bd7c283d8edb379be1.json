{"ast":null,"code":"import _objectSpread from\"/Users/te/Desktop/sickoscoop/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// App.js - Updated with new file size limits and enhanced PDF handling\nimport React,{useState,useRef,useEffect,useCallback}from'react';import{Heart,MessageCircle,Share2,Send,Image,Video,FileText,Mic,Search,Settings,X,MoreHorizontal,Flag,Bookmark,Eye,ArrowLeft,Clock,Users,Copy,ExternalLink,Twitter,Facebook,Linkedin,CheckCircle,AlertCircle}from'lucide-react';// Fixed API base configuration - always use same origin (eliminates CORS!)\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const API_BASE='/api';// Enhanced URL generation for posts\nconst generatePostUrl=postId=>{const baseUrl=window.location.hostname==='localhost'?'http://localhost:3000':'https://sickoscoop.netlify.app';return\"\".concat(baseUrl,\"/post/\").concat(postId);};// Enhanced timestamp function with more details\nconst getDetailedTimestamp=date=>{const now=new Date();const postDate=new Date(date);const diffInMinutes=Math.floor((now-postDate)/(1000*60));if(diffInMinutes<1)return{relative:'Just now',absolute:postDate.toLocaleTimeString()};if(diffInMinutes<60)return{relative:\"\".concat(diffInMinutes,\"m ago\"),absolute:postDate.toLocaleString()};const diffInHours=Math.floor(diffInMinutes/60);if(diffInHours<24)return{relative:\"\".concat(diffInHours,\"h ago\"),absolute:postDate.toLocaleString()};const diffInDays=Math.floor(diffInHours/24);if(diffInDays<7)return{relative:\"\".concat(diffInDays,\"d ago\"),absolute:postDate.toLocaleDateString()};const diffInWeeks=Math.floor(diffInDays/7);if(diffInWeeks<4)return{relative:\"\".concat(diffInWeeks,\"w ago\"),absolute:postDate.toLocaleDateString()};return{relative:postDate.toLocaleDateString(),absolute:postDate.toLocaleString()};};// Enhanced Share Modal Component\nconst ShareModal=/*#__PURE__*/React.memo(_ref=>{var _post$userId,_post$userId2,_post$userId2$usernam,_post$userId3;let{post,isOpen,onClose}=_ref;const[copied,setCopied]=useState(false);const postUrl=generatePostUrl(post._id);const shareText=\"Check out this post by \".concat(((_post$userId=post.userId)===null||_post$userId===void 0?void 0:_post$userId.username)||'someone',\" on SickoScoop: \\\"\").concat(post.content.substring(0,100)).concat(post.content.length>100?'...':'',\"\\\"\");const handleCopyLink=async()=>{try{await navigator.clipboard.writeText(postUrl);setCopied(true);setTimeout(()=>setCopied(false),2000);}catch(error){console.error('Failed to copy:',error);const textArea=document.createElement('textarea');textArea.value=postUrl;document.body.appendChild(textArea);textArea.select();document.execCommand('copy');document.body.removeChild(textArea);setCopied(true);setTimeout(()=>setCopied(false),2000);}};const handleSocialShare=platform=>{const encodedText=encodeURIComponent(shareText);const encodedUrl=encodeURIComponent(postUrl);const shareUrls={twitter:\"https://twitter.com/intent/tweet?text=\".concat(encodedText,\"&url=\").concat(encodedUrl),facebook:\"https://www.facebook.com/sharer/sharer.php?u=\".concat(encodedUrl),linkedin:\"https://www.linkedin.com/sharing/share-offsite/?url=\".concat(encodedUrl),reddit:\"https://reddit.com/submit?url=\".concat(encodedUrl,\"&title=\").concat(encodedText),email:\"mailto:?subject=\".concat(encodeURIComponent('Check out this SickoScoop post'),\"&body=\").concat(encodedText,\"%0A%0A\").concat(encodedUrl)};if(shareUrls[platform]){window.open(shareUrls[platform],'_blank','width=600,height=400');}};const handleNativeShare=async()=>{if(navigator.share){try{await navigator.share({title:'SickoScoop Post',text:shareText,url:postUrl});}catch(error){console.error('Error sharing:',error);}}};if(!isOpen)return null;return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50\",onClick:onClose,children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-r from-slate-900/95 to-zinc-900/95 backdrop-blur-md rounded-2xl border border-slate-600/50 shadow-2xl max-w-md w-full mx-4\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-6 border-b border-slate-600/30\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-white\",children:\"Share Post\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"p-2 text-slate-400 hover:text-white hover:bg-slate-700/50 rounded-lg transition-colors\",children:/*#__PURE__*/_jsx(X,{className:\"h-5 w-5\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-slate-800/50 rounded-lg p-4 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 mb-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 bg-gradient-to-r from-slate-600 to-zinc-600 rounded-full flex items-center justify-center text-white font-semibold text-xs\",children:((_post$userId2=post.userId)===null||_post$userId2===void 0?void 0:(_post$userId2$usernam=_post$userId2.username)===null||_post$userId2$usernam===void 0?void 0:_post$userId2$usernam.slice(0,2).toUpperCase())||'UN'}),/*#__PURE__*/_jsx(\"span\",{className:\"text-white font-medium\",children:((_post$userId3=post.userId)===null||_post$userId3===void 0?void 0:_post$userId3.username)||'Unknown User'})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-slate-300 text-sm line-clamp-3\",children:post.content})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-slate-300 mb-2\",children:\"Post Link\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:postUrl,readOnly:true,className:\"flex-1 px-3 py-2 bg-black/40 border border-slate-600/50 rounded-lg text-white text-sm focus:outline-none focus:ring-2 focus:ring-amber-500/50\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:handleCopyLink,className:\"px-4 py-2 rounded-lg transition-all duration-200 flex items-center space-x-2 \".concat(copied?'bg-green-600 text-white':'bg-slate-700 text-slate-300 hover:bg-slate-600'),children:[/*#__PURE__*/_jsx(Copy,{className:\"h-4 w-4\"}),/*#__PURE__*/_jsx(\"span\",{children:copied?'Copied!':'Copy'})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-slate-300\",children:\"Share to\"}),navigator.share&&/*#__PURE__*/_jsxs(\"button\",{onClick:handleNativeShare,className:\"w-full flex items-center space-x-3 p-3 bg-slate-700/50 hover:bg-slate-700/70 rounded-lg transition-colors text-white\",children:[/*#__PURE__*/_jsx(Share2,{className:\"h-5 w-5\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Share via device\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-3\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleSocialShare('twitter'),className:\"flex items-center space-x-3 p-3 bg-blue-600/20 hover:bg-blue-600/30 rounded-lg transition-colors text-blue-400 border border-blue-600/30\",children:[/*#__PURE__*/_jsx(Twitter,{className:\"h-5 w-5\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Twitter\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleSocialShare('facebook'),className:\"flex items-center space-x-3 p-3 bg-blue-700/20 hover:bg-blue-700/30 rounded-lg transition-colors text-blue-300 border border-blue-700/30\",children:[/*#__PURE__*/_jsx(Facebook,{className:\"h-5 w-5\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Facebook\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleSocialShare('linkedin'),className:\"flex items-center space-x-3 p-3 bg-blue-800/20 hover:bg-blue-800/30 rounded-lg transition-colors text-blue-200 border border-blue-800/30\",children:[/*#__PURE__*/_jsx(Linkedin,{className:\"h-5 w-5\"}),/*#__PURE__*/_jsx(\"span\",{children:\"LinkedIn\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleSocialShare('email'),className:\"flex items-center space-x-3 p-3 bg-slate-700/20 hover:bg-slate-700/30 rounded-lg transition-colors text-slate-300 border border-slate-700/30\",children:[/*#__PURE__*/_jsx(ExternalLink,{className:\"h-5 w-5\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Email\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"pt-4 border-t border-slate-600/30\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleSocialShare('reddit'),className:\"w-full flex items-center space-x-3 p-3 bg-orange-600/20 hover:bg-orange-600/30 rounded-lg transition-colors text-orange-400 border border-orange-600/30\",children:[/*#__PURE__*/_jsx(ExternalLink,{className:\"h-5 w-5\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Share to Reddit\"})]})})]})]})]})});});// Enhanced Video Player Component\nconst EnhancedVideoPlayer=/*#__PURE__*/React.memo(_ref2=>{let{file}=_ref2;const[isLoading,setIsLoading]=useState(true);const[hasError,setHasError]=useState(false);const[isPlaying,setIsPlaying]=useState(false);const videoRef=useRef(null);const handleLoadedData=()=>{setIsLoading(false);setHasError(false);};const handleError=()=>{setIsLoading(false);setHasError(true);};const handlePlay=()=>{setIsPlaying(true);};const handlePause=()=>{setIsPlaying(false);};const handleClick=e=>{e.stopPropagation();if(videoRef.current){if(isPlaying){videoRef.current.pause();}else{videoRef.current.play();}}};return/*#__PURE__*/_jsxs(\"div\",{className:\"relative w-full bg-black rounded-xl overflow-hidden\",children:[isLoading&&/*#__PURE__*/_jsxs(\"div\",{className:\"absolute inset-0 flex items-center justify-center bg-slate-800/50 z-10\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-8 w-8 border-b-2 border-white\"}),/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-white text-sm\",children:\"Loading video...\"})]}),hasError?/*#__PURE__*/_jsxs(\"div\",{className:\"p-8 text-center bg-slate-800/50\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-red-400 mb-2\",children:[/*#__PURE__*/_jsx(Video,{className:\"h-8 w-8 mx-auto mb-2\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Unable to load video\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-slate-400 text-sm\",children:file.filename}),/*#__PURE__*/_jsx(\"a\",{href:file.url,target:\"_blank\",rel:\"noopener noreferrer\",className:\"mt-2 inline-block text-blue-400 hover:text-blue-300 text-sm underline\",onClick:e=>e.stopPropagation(),children:\"Download video\"})]}):/*#__PURE__*/_jsxs(\"video\",{ref:videoRef,className:\"w-full h-auto max-h-96 cursor-pointer\",onLoadedData:handleLoadedData,onError:handleError,onPlay:handlePlay,onPause:handlePause,onClick:handleClick,preload:\"metadata\",playsInline:true,children:[/*#__PURE__*/_jsx(\"source\",{src:file.url,type:file.mimeType||file.type}),\"Your browser does not support video playback.\"]}),!isLoading&&!hasError&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute bottom-2 left-2 bg-black/60 rounded px-2 py-1 text-white text-xs\",children:file.filename})]});});// URL Router simulation\nconst useSimpleRouter=()=>{const[currentPath,setCurrentPath]=useState(window.location.pathname);useEffect(()=>{const handlePopState=()=>{setCurrentPath(window.location.pathname);};window.addEventListener('popstate',handlePopState);return()=>window.removeEventListener('popstate',handlePopState);},[]);const navigate=path=>{window.history.pushState({},'',path);setCurrentPath(path);};return{currentPath,navigate};};// Landing Page Component\nconst LandingPage=/*#__PURE__*/React.memo(_ref3=>{let{loginForm,setLoginForm,registerForm,setRegisterForm,showRegister,setShowRegister,handleLogin,handleRegister,loading,error,onBrowsePublic}=_ref3;return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen relative overflow-hidden border-4 border-orange-600/80\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 bg-gradient-to-br from-gray-900 via-slate-900 to-zinc-900\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"absolute inset-0 opacity-10\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-10 left-10 w-32 h-32 bg-gradient-to-r from-purple-800 to-indigo-700 rounded-full blur-xl animate-pulse\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute top-40 right-20 w-24 h-24 bg-gradient-to-r from-slate-700 to-gray-600 rounded-full blur-lg animate-pulse delay-1000\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute bottom-20 left-1/3 w-40 h-40 bg-gradient-to-r from-zinc-800 to-slate-700 rounded-full blur-2xl animate-pulse delay-2000\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative z-10 flex flex-col items-center justify-center min-h-screen p-8 text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-8 relative\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-6xl md:text-8xl font-bold bg-gradient-to-r from-slate-300 via-purple-400 to-indigo-400 bg-clip-text text-transparent\",children:\"SickoScoop\"})}),/*#__PURE__*/_jsxs(\"h1\",{className:\"text-4xl md:text-6xl font-bold text-white mb-10 drop-shadow-2xl leading-none\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"whitespace-nowrap\",children:\"STOP STALKERS\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"span\",{className:\"text-2xl md:text-4xl block my-2\",children:\"ON\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"bg-gradient-to-r from-orange-300 via-red-400 via-blue-400 to-indigo-400 bg-clip-text text-transparent block animate-pulse relative\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"absolute inset-0 bg-gradient-to-r from-orange-200 via-red-300 via-cyan-300 to-blue-300 bg-clip-text text-transparent blur-sm opacity-80\"}),/*#__PURE__*/_jsx(\"span\",{className:\"absolute inset-0 bg-gradient-to-r from-amber-300 via-rose-300 via-sky-300 to-violet-300 bg-clip-text text-transparent blur-xs opacity-40\"}),\"SICKOSCOOP\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-8 flex flex-col items-center\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:onBrowsePublic,className:\"px-8 py-3 bg-gradient-to-r from-gray-900 via-slate-800 to-black text-white text-lg font-semibold rounded-lg hover:scale-105 transform transition-all duration-300 shadow-2xl hover:shadow-amber-500/50 border-2 border-amber-500/80 hover:border-amber-400 hover:from-gray-800 hover:via-slate-700 hover:to-gray-900 backdrop-blur-md flex items-center space-x-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative w-6 h-6\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 bg-gradient-to-br from-purple-400 via-indigo-500 to-violet-600 rounded-full opacity-80 blur-sm animate-pulse\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-1 bg-gradient-to-tr from-orange-400 via-amber-500 to-red-500 rounded-full opacity-90\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 bg-gradient-to-br from-cyan-400 via-blue-500 to-indigo-600 transform rotate-45 opacity-70 blur-sm\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-1 bg-gradient-to-tr from-amber-300 via-orange-400 to-red-400 transform rotate-45 opacity-80\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 bg-gradient-to-bl from-violet-400 via-purple-500 to-indigo-600 opacity-60\",style:{clipPath:'polygon(50% 10%, 10% 90%, 90% 90%)'}}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-1 bg-gradient-to-tl from-orange-300 via-amber-400 to-yellow-400 opacity-70 animate-pulse\",style:{clipPath:'polygon(50% 15%, 15% 85%, 85% 85%)'}})]}),/*#__PURE__*/_jsx(\"span\",{children:\"Browse Public Feed\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-slate-400 text-sm mt-2\",children:\"See what people are sharing \\u2022 No account required\"})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"mb-4 p-3 bg-red-500/20 border border-red-500/50 rounded-lg text-red-300 max-w-md\",children:error}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-8 w-full max-w-md\",children:[!showRegister?/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"email\",placeholder:\"Email\",value:loginForm.email,onChange:e=>setLoginForm(prev=>_objectSpread(_objectSpread({},prev),{},{email:e.target.value})),onKeyDown:e=>e.key==='Enter'&&handleLogin(),autoComplete:\"email\",className:\"w-full p-3 bg-black/40 border border-slate-600/50 rounded-lg text-white placeholder-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",placeholder:\"Password\",value:loginForm.password,onChange:e=>setLoginForm(prev=>_objectSpread(_objectSpread({},prev),{},{password:e.target.value})),onKeyDown:e=>e.key==='Enter'&&handleLogin(),autoComplete:\"current-password\",className:\"w-full p-3 bg-black/40 border border-slate-600/50 rounded-lg text-white placeholder-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-400\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogin,disabled:loading,className:\"w-full px-12 py-4 bg-gradient-to-r from-gray-900 via-slate-800 to-black text-white text-xl font-semibold rounded-lg hover:scale-105 transform transition-all duration-300 shadow-2xl hover:shadow-amber-500/50 border-2 border-amber-500/80 hover:border-amber-400 hover:from-gray-800 hover:via-slate-700 hover:to-gray-900 disabled:opacity-50\",children:loading?'Entering...':'Enter Sicko'})]}):/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Username\",value:registerForm.username,onChange:e=>setRegisterForm(prev=>_objectSpread(_objectSpread({},prev),{},{username:e.target.value})),onKeyDown:e=>e.key==='Enter'&&handleRegister(),autoComplete:\"username\",className:\"w-full p-3 bg-black/40 border border-slate-600/50 rounded-lg text-white placeholder-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",placeholder:\"Email\",value:registerForm.email,onChange:e=>setRegisterForm(prev=>_objectSpread(_objectSpread({},prev),{},{email:e.target.value})),onKeyDown:e=>e.key==='Enter'&&handleRegister(),autoComplete:\"email\",className:\"w-full p-3 bg-black/40 border border-slate-600/50 rounded-lg text-white placeholder-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-400\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",placeholder:\"Password\",value:registerForm.password,onChange:e=>setRegisterForm(prev=>_objectSpread(_objectSpread({},prev),{},{password:e.target.value})),onKeyDown:e=>e.key==='Enter'&&handleRegister(),autoComplete:\"new-password\",className:\"w-full p-3 bg-black/40 border border-slate-600/50 rounded-lg text-white placeholder-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-400\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleRegister,disabled:loading,className:\"w-full px-12 py-4 bg-gradient-to-r from-gray-900 via-slate-800 to-black text-white text-xl font-semibold rounded-lg hover:scale-105 transform transition-all duration-300 shadow-2xl hover:shadow-amber-500/50 border-2 border-amber-500/80 hover:border-amber-400 hover:from-gray-800 hover:via-slate-700 hover:to-gray-900 disabled:opacity-50\",children:loading?'Creating Account...':'Join Sicko'})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowRegister(!showRegister),className:\"mt-4 text-slate-300 hover:text-white transition-colors\",children:showRegister?'Already have an account? Sign in':'Need an account? Register'})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-16 grid grid-cols-1 md:grid-cols-3 gap-8 max-w-4xl\",children:[{icon:/*#__PURE__*/_jsxs(\"div\",{className:\"relative w-12 h-12\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 bg-gradient-to-br from-purple-300 via-indigo-400 to-violet-500 rounded-full opacity-80 blur-sm\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-1 bg-gradient-to-tr from-orange-300 via-orange-400 to-blue-500 rounded-full opacity-90 animate-pulse\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-2 bg-gradient-to-bl from-blue-300 via-purple-400 to-indigo-500 rounded-full opacity-70\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-3 bg-gradient-to-tl from-orange-300 via-purple-300 to-blue-400 rounded-full animate-pulse\"})]}),title:'Anti-Stalker Protection',desc:'Advanced privacy controls'},{icon:/*#__PURE__*/_jsxs(\"div\",{className:\"relative w-12 h-12\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 bg-gradient-to-br from-purple-300 via-indigo-400 to-violet-500 transform rotate-45 opacity-80 blur-sm\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-1 bg-gradient-to-tr from-orange-300 via-orange-400 to-blue-500 transform rotate-45 opacity-90 animate-pulse\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-2 bg-gradient-to-bl from-blue-300 via-purple-400 to-indigo-500 transform rotate-45 opacity-70\"}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-3 bg-gradient-to-tl from-orange-300 via-purple-300 to-blue-400 transform rotate-45 animate-pulse\"})]}),title:'Decency',desc:'No anonymous trolls'},{icon:/*#__PURE__*/_jsxs(\"div\",{className:\"relative w-12 h-12\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-0 bg-gradient-to-br from-violet-400 via-purple-500 to-indigo-600 opacity-80 blur-sm\",style:{clipPath:'polygon(50% 0%, 0% 100%, 100% 100%)'}}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-1 bg-gradient-to-tr from-orange-400 via-blue-700 to-amber-500 opacity-90 animate-pulse\",style:{clipPath:'polygon(50% 0%, 0% 100%, 100% 100%)'}}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-2 bg-gradient-to-bl from-teal-400 via-cyan-500 to-blue-600 opacity-70\",style:{clipPath:'polygon(50% 0%, 0% 100%, 100% 100%)'}}),/*#__PURE__*/_jsx(\"div\",{className:\"absolute inset-3 bg-gradient-to-tl from-blue-900 via-indigo-800 to-slate-800 animate-pulse\",style:{clipPath:'polygon(50% 0%, 0% 100%, 100% 100%)'}})]}),title:'Genuine Community',desc:'Keeping everyone safe'}].map((feature,idx)=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-black/20 backdrop-blur-md rounded-2xl p-6 border border-slate-600/30 hover:bg-black/30 transition-all duration-300\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"inline-block border-2 border-amber-500/80 rounded-lg p-3 mb-4 bg-black/30\",children:feature.icon}),/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-white mb-2\",children:feature.title}),/*#__PURE__*/_jsx(\"p\",{className:\"text-slate-300\",children:feature.desc})]},idx))})]})]});});// Header component\nconst Header=/*#__PURE__*/React.memo(_ref4=>{var _selectedPost$userId,_user$username;let{currentView,setCurrentView,apiStatus,handleLogout,user,selectedPost,onBackToFeed,navigate}=_ref4;const[isMobileMenuOpen,setIsMobileMenuOpen]=useState(false);const[isSearchOpen,setIsSearchOpen]=useState(false);return/*#__PURE__*/_jsx(\"header\",{className:\"bg-gradient-to-r from-gray-900 via-slate-900 to-zinc-900 shadow-2xl border-b border-amber-500/30 backdrop-blur-md relative z-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto px-4 py-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 flex-shrink-0\",children:[currentView==='post'&&/*#__PURE__*/_jsx(\"button\",{onClick:onBackToFeed,className:\"p-2 text-slate-300 hover:text-white transition-colors rounded-lg hover:bg-slate-800/50 mr-2\",title:\"Back to Feed\",children:/*#__PURE__*/_jsx(ArrowLeft,{className:\"h-5 w-5\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{navigate('/');setCurrentView('feed');},className:\"text-xl md:text-2xl lg:text-3xl font-bold bg-gradient-to-r from-slate-300 to-purple-400 bg-clip-text text-transparent hover:scale-105 transition-transform\",children:\"SickoScoop\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setIsMobileMenuOpen(!isMobileMenuOpen),className:\"md:hidden p-2 text-slate-300 hover:text-white transition-colors rounded-lg hover:bg-slate-800/50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"w-5 h-5 flex flex-col justify-center space-y-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"h-0.5 bg-current transition-all duration-300 \".concat(isMobileMenuOpen?'rotate-45 translate-y-1.5':'')}),/*#__PURE__*/_jsx(\"div\",{className:\"h-0.5 bg-current transition-all duration-300 \".concat(isMobileMenuOpen?'opacity-0':'')}),/*#__PURE__*/_jsx(\"div\",{className:\"h-0.5 bg-current transition-all duration-300 \".concat(isMobileMenuOpen?'-rotate-45 -translate-y-1.5':'')})]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"hidden md:flex items-center space-x-3 flex-1 justify-center max-w-2xl\",children:currentView==='post'?/*#__PURE__*/_jsx(\"div\",{className:\"text-center text-slate-300\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"text-lg font-medium\",children:[\"Post by \",(selectedPost===null||selectedPost===void 0?void 0:(_selectedPost$userId=selectedPost.userId)===null||_selectedPost$userId===void 0?void 0:_selectedPost$userId.username)||'Unknown User']})}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{navigate('/');setCurrentView('feed');},className:\"px-4 py-2 rounded-lg border-2 transition-all duration-200 font-medium text-sm lg:text-base \".concat(currentView==='feed'?'bg-slate-700 text-white border-amber-500 shadow-lg shadow-amber-500/20':'text-slate-300 hover:text-white border-amber-600/50 hover:border-amber-500 hover:bg-slate-800/50'),children:\"Feed\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{navigate('/profile');setCurrentView('profile');},className:\"px-4 py-2 rounded-lg border-2 transition-all duration-200 font-medium text-sm lg:text-base \".concat(currentView==='profile'?'bg-slate-700 text-white border-amber-500 shadow-lg shadow-amber-500/20':'text-slate-300 hover:text-white border-amber-600/50 hover:border-amber-500 hover:bg-slate-800/50'),children:\"Profile\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{navigate('/chat');setCurrentView('chat');},className:\"px-4 py-2 rounded-lg border-2 transition-all duration-200 font-medium text-sm lg:text-base \".concat(currentView==='chat'?'bg-slate-700 text-white border-amber-500 shadow-lg shadow-amber-500/20':'text-slate-300 hover:text-white border-amber-600/50 hover:border-amber-500 hover:bg-slate-800/50'),children:\"Chat\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"hidden lg:block relative ml-4\",children:[/*#__PURE__*/_jsx(Search,{className:\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-slate-500\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search sicko...\",className:\"w-64 xl:w-72 pl-10 pr-4 py-2 bg-black/40 border border-slate-600/60 rounded-full text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-amber-500/50 focus:border-amber-500/70 transition-all duration-200 text-sm\"})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center flex-shrink-0 mr-2\",children:[currentView!=='post'&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>setIsSearchOpen(!isSearchOpen),className:\"lg:hidden p-2 text-slate-300 hover:text-white transition-colors rounded-lg hover:bg-slate-800/50 mr-3\",children:/*#__PURE__*/_jsx(Search,{className:\"h-5 w-5\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 rounded-full flex items-center justify-center font-bold shadow-lg transition-all duration-200 cursor-pointer hover:scale-110 hover:shadow-xl text-sm bg-gradient-to-r from-amber-500 to-orange-600 border-2 border-amber-500/80 text-white mr-3\",onClick:()=>setIsMobileMenuOpen(!isMobileMenuOpen),children:(user===null||user===void 0?void 0:(_user$username=user.username)===null||_user$username===void 0?void 0:_user$username.slice(0,2).toUpperCase())||'YU'}),/*#__PURE__*/_jsx(\"button\",{className:\"p-2 text-slate-300 hover:text-white transition-colors duration-200 hover:bg-slate-800/50 rounded-lg mr-3\",children:/*#__PURE__*/_jsx(Settings,{className:\"h-5 w-5\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,className:\"hidden sm:flex px-3 py-2 text-sm rounded-lg transition-all duration-200 hover:scale-105 bg-slate-700/40 text-slate-300 border-2 border-amber-600/40 hover:border-amber-500 hover:bg-slate-700/60 hover:text-white font-semibold\",children:\"Logout\"})]})]}),isSearchOpen&&currentView!=='post'&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-3 lg:hidden\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(Search,{className:\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-slate-500\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search sicko...\",className:\"w-full pl-10 pr-4 py-3 bg-black/40 border border-slate-600/60 rounded-full text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-amber-500/50 focus:border-amber-500/70 transition-all duration-200\",autoFocus:true})]})}),isMobileMenuOpen&&/*#__PURE__*/_jsx(\"div\",{className:\"md:hidden mt-4 pb-2 bg-black/20 rounded-xl p-4 border border-slate-600/30\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col space-y-3\",children:[currentView==='post'&&/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{onBackToFeed();setIsMobileMenuOpen(false);},className:\"px-4 py-3 rounded-lg border-2 border-amber-600/50 bg-slate-700/40 text-slate-300 hover:text-white hover:border-amber-500 hover:bg-slate-700/60 transition-all duration-200 font-medium text-left flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(ArrowLeft,{className:\"h-5 w-5\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Back to Feed\"})]}),currentView!=='post'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{navigate('/');setCurrentView('feed');setIsMobileMenuOpen(false);},className:\"px-4 py-3 rounded-lg border-2 transition-all duration-200 font-medium text-left flex items-center space-x-3 \".concat(currentView==='feed'?'bg-slate-700 text-white border-amber-500 shadow-lg shadow-amber-500/20':'text-slate-300 hover:text-white border-amber-600/50 hover:border-amber-500 hover:bg-slate-800/50'),children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-lg\",children:\"\\uD83D\\uDCF1\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Feed\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{navigate('/profile');setCurrentView('profile');setIsMobileMenuOpen(false);},className:\"px-4 py-3 rounded-lg border-2 transition-all duration-200 font-medium text-left flex items-center space-x-3 \".concat(currentView==='profile'?'bg-slate-700 text-white border-amber-500 shadow-lg shadow-amber-500/20':'text-slate-300 hover:text-white border-amber-600/50 hover:border-amber-500 hover:bg-slate-800/50'),children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-lg\",children:\"\\uD83D\\uDC64\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Profile\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{navigate('/chat');setCurrentView('chat');setIsMobileMenuOpen(false);},className:\"px-4 py-3 rounded-lg border-2 transition-all duration-200 font-medium text-left flex items-center space-x-3 \".concat(currentView==='chat'?'bg-slate-700 text-white border-amber-500 shadow-lg shadow-amber-500/20':'text-slate-300 hover:text-white border-amber-600/50 hover:border-amber-500 hover:bg-slate-800/50'),children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-lg\",children:\"\\uD83D\\uDCAC\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Chat\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"border-t border-slate-600/40 my-2\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{handleLogout();setIsMobileMenuOpen(false);},className:\"px-4 py-3 rounded-lg border-2 border-amber-600/40 bg-slate-700/40 text-slate-300 hover:text-white hover:border-amber-500 hover:bg-slate-700/60 transition-all duration-200 font-medium text-left flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-lg\",children:\"\\uD83D\\uDEAA\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Logout\"})]})]})})]})});});// ✅ UPDATED POST CREATOR with new file size limits\nconst PostCreator=/*#__PURE__*/React.memo(_ref5=>{var _user$username2;let{user,newPost,setNewPost,handlePost,loading,fileInputRef,handleFileUpload}=_ref5;const[uploadedFiles,setUploadedFiles]=useState([]);const[uploadProgress,setUploadProgress]=useState({});const[isUploading,setIsUploading]=useState(false);const[uploadError,setUploadError]=useState('');const pdfInputRef=useRef(null);const audioInputRef=useRef(null);const videoInputRef=useRef(null);const photoInputRef=useRef(null);// ✅ UPDATED FILE SIZE LIMITS (in your App.js PostCreator component)\nconst FILE_LIMITS={image:{max:20*1024*1024,label:'20MB'},// ✅ Was 10MB\nvideo:{max:200*1024*1024,label:'200MB'},// ✅ Was 100MB  \naudio:{max:50*1024*1024,label:'50MB'},// ✅ Was 25MB\npdf:{max:50*1024*1024,label:'50MB'}// ✅ Was 10MB\n};// VALIDATE FILE SIZE before upload\nconst validateFile=(file,type)=>{const limit=FILE_LIMITS[type];if(!limit)return{valid:false,error:\"Unknown file type: \".concat(type)};if(file.size>limit.max){return{valid:false,error:\"\".concat(type.charAt(0).toUpperCase()+type.slice(1),\" files must be under \").concat(limit.label,\". Your file is \").concat((file.size/1024/1024).toFixed(1),\"MB.\")};}return{valid:true};};// Handle file selection for specific types\nconst handleFileSelect=async(type,files)=>{console.log('🔄 handleFileSelect called:',type,files===null||files===void 0?void 0:files.length);if(!files||files.length===0)return;const fileArray=Array.from(files);setUploadError('');// Validate file types and sizes\nconst allowedTypes={pdf:['application/pdf'],audio:['audio/mpeg','audio/wav','audio/ogg','audio/mp3','audio/mp4'],video:['video/mp4','video/mpeg','video/quicktime','video/webm','video/mov'],image:['image/jpeg','image/png','image/gif','image/webp']};const validFiles=[];const errors=[];for(const file of fileArray){// Check file type\nif(!allowedTypes[type].includes(file.type)){errors.push(\"\".concat(file.name,\": Invalid file type. Expected \").concat(type.toUpperCase(),\".\"));continue;}// Check file size\nconst validation=validateFile(file,type);if(!validation.valid){errors.push(\"\".concat(file.name,\": \").concat(validation.error));continue;}validFiles.push(file);}if(errors.length>0){setUploadError(errors.join('\\n'));return;}if(validFiles.length===0){setUploadError(\"Please select valid \".concat(type,\" files.\"));return;}await uploadFiles(validFiles);};// ✅ UPDATED upload function with adjusted timeouts for smaller file sizes\nconst uploadFiles=async files=>{console.log('🚀 uploadFiles called with:',files===null||files===void 0?void 0:files.length,'files');if(!files||files.length===0)return;setIsUploading(true);setUploadError('');setUploadProgress({});const formData=new FormData();Array.from(files).forEach(file=>{formData.append('files',file);});let progressInterval;try{console.log('📤 Uploading files:',files.length);const totalSize=Array.from(files).reduce((sum,file)=>sum+file.size,0);const totalSizeMB=(totalSize/1024/1024).toFixed(1);const sizeLabel=\"\".concat(totalSizeMB,\"MB\");console.log(\"\\uD83D\\uDCCA Total upload size: \".concat(sizeLabel));const token=localStorage.getItem('authToken');const controller=new AbortController();// ✅ ADJUSTED TIMEOUT for smaller files (10 minutes instead of 20)\nconst timeoutId=setTimeout(()=>{controller.abort();setUploadError('Upload timed out. Large files may take up to 10 minutes. Please try with smaller files or check your connection.');},10*60*1000);// 10 minutes\nconst startTime=Date.now();setUploadProgress({status:'uploading',progress:0,totalSize:sizeLabel});// SIMULATE PROGRESS based on file size\nprogressInterval=setInterval(()=>{const elapsed=Date.now()-startTime;// Estimate based on file size: adjusted for smaller max file sizes\nconst estimatedTotal=Math.max(15000,totalSize/2000);// At least 15 seconds, faster for smaller files\nconst progress=Math.min(90,elapsed/estimatedTotal*100);setUploadProgress(prev=>_objectSpread(_objectSpread({},prev),{},{progress:Math.round(progress),elapsed:Math.round(elapsed/1000)}));},1500);// Update every 1.5 seconds\nconst response=await fetch(\"\".concat(API_BASE,\"/media/upload\"),{method:'POST',headers:{'Authorization':token?\"Bearer \".concat(token):''},body:formData,signal:controller.signal});clearTimeout(timeoutId);clearInterval(progressInterval);if(!response.ok){const errorData=await response.json().catch(()=>({}));throw new Error(errorData.message||\"Upload failed: \".concat(response.statusText));}const result=await response.json();console.log('✅ Upload successful:',result);setUploadProgress({status:'completed',progress:100});if(result.files&&Array.isArray(result.files)){setUploadedFiles(prev=>[...prev,...result.files]);console.log('📁 Files added to state:',result.files.length);// Show completion status \nsetTimeout(()=>{setUploadProgress({});},2000);}else{throw new Error('Invalid response format from server');}}catch(error){console.error('❌ Upload error:',error);if(progressInterval)clearInterval(progressInterval);if(error.name==='AbortError'){setUploadError('Upload was cancelled due to timeout. Large files can take up to 10 minutes. Please try with smaller files.');}else{setUploadError(\"Upload failed: \".concat(error.message));}setUploadProgress({});}finally{setIsUploading(false);}};// Remove uploaded file\nconst removeFile=index=>{setUploadedFiles(prev=>prev.filter((_,i)=>i!==index));};// Clear upload error\nconst clearError=()=>{setUploadError('');};// Check if we have content to post\nconst hasContent=newPost.trim()||uploadedFiles.length>0;// Handle post submission with files\nconst handleSubmitPost=async()=>{if(!hasContent)return;try{await handlePost(uploadedFiles);// Clear uploaded files after successful post\nsetUploadedFiles([]);// Clear file input values\nif(pdfInputRef.current)pdfInputRef.current.value='';if(audioInputRef.current)audioInputRef.current.value='';if(videoInputRef.current)videoInputRef.current.value='';if(photoInputRef.current)photoInputRef.current.value='';}catch(error){console.error('Post submission error:',error);}};// Get file type icon and color\nconst getFileIcon=file=>{const icons={image:{icon:/*#__PURE__*/_jsx(Image,{className:\"h-4 w-4\"}),color:'text-blue-400',bg:'bg-blue-500/20'},video:{icon:/*#__PURE__*/_jsx(Video,{className:\"h-4 w-4\"}),color:'text-red-400',bg:'bg-red-500/20'},audio:{icon:/*#__PURE__*/_jsx(Mic,{className:\"h-4 w-4\"}),color:'text-green-400',bg:'bg-green-500/20'},document:{icon:/*#__PURE__*/_jsx(FileText,{className:\"h-4 w-4\"}),color:'text-orange-400',bg:'bg-orange-500/20'},pdf:{icon:/*#__PURE__*/_jsx(FileText,{className:\"h-4 w-4\"}),color:'text-red-400',bg:'bg-red-500/20'}};if(icons[file.type]){return icons[file.type];}else if(file.mimeType==='application/pdf'){return icons.pdf;}else{return icons.document;}};return/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-r from-slate-900/60 to-zinc-900/60 backdrop-blur-md rounded-2xl p-6 border border-slate-600/40 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-12 h-12 bg-gradient-to-r from-slate-600 to-zinc-600 rounded-full flex items-center justify-center text-white font-semibold\",children:(user===null||user===void 0?void 0:(_user$username2=user.username)===null||_user$username2===void 0?void 0:_user$username2.slice(0,2).toUpperCase())||'YU'}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"textarea\",{value:newPost,onChange:e=>setNewPost(e.target.value),placeholder:\"Share your thoughts...\",className:\"w-full p-4 bg-black/40 border border-slate-600/50 rounded-xl text-white placeholder-slate-300 resize-none focus:outline-none focus:ring-2 focus:ring-slate-400\",rows:\"3\"}),uploadError&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-3 p-3 bg-red-500/20 border border-red-500/50 rounded-lg\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start space-x-2\",children:[/*#__PURE__*/_jsx(AlertCircle,{className:\"h-4 w-4 text-red-400 mt-0.5 flex-shrink-0\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-300 text-sm whitespace-pre-line\",children:uploadError})]}),/*#__PURE__*/_jsx(\"button\",{onClick:clearError,className:\"text-red-400 hover:text-red-300 ml-2\",children:/*#__PURE__*/_jsx(X,{className:\"h-4 w-4\"})})]})}),uploadProgress.status&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-3 p-4 bg-blue-500/10 border border-blue-500/30 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[uploadProgress.status==='completed'?/*#__PURE__*/_jsx(CheckCircle,{className:\"h-4 w-4 text-green-400\"}):/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-400\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-blue-400 text-sm font-medium\",children:uploadProgress.status==='completed'?'Upload Complete!':'Uploading files...'})]}),uploadProgress.totalSize&&/*#__PURE__*/_jsx(\"span\",{className:\"text-blue-300 text-xs\",children:uploadProgress.totalSize})]}),uploadProgress.progress!==undefined&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-full bg-slate-800/50 rounded-full h-2\",children:/*#__PURE__*/_jsx(\"div\",{className:\"bg-blue-400 h-2 rounded-full transition-all duration-500\",style:{width:\"\".concat(uploadProgress.progress,\"%\")}})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between text-xs text-blue-300 mt-1\",children:[/*#__PURE__*/_jsxs(\"span\",{children:[uploadProgress.progress,\"% complete\"]}),uploadProgress.elapsed&&/*#__PURE__*/_jsxs(\"span\",{children:[Math.floor(uploadProgress.elapsed/60),\":\",String(uploadProgress.elapsed%60).padStart(2,'0'),\" elapsed\"]})]})]}),uploadProgress.status==='uploading'&&/*#__PURE__*/_jsx(\"p\",{className:\"text-blue-300 text-xs\",children:\"Large files may take several minutes to upload. Please be patient.\"})]}),uploadedFiles.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 space-y-3\",children:[/*#__PURE__*/_jsxs(\"h4\",{className:\"text-sm font-medium text-slate-300 flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(CheckCircle,{className:\"h-4 w-4 text-green-400\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Uploaded Files (\",uploadedFiles.length,\")\"]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"grid gap-3\",children:uploadedFiles.map((file,index)=>{const fileStyle=getFileIcon(file);return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-3 bg-black/30 rounded-lg border border-slate-600/30\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-2 \".concat(fileStyle.bg,\" rounded-lg \").concat(fileStyle.color),children:fileStyle.icon}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-medium text-sm\",children:file.filename}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"text-slate-400 text-xs\",children:[file.type.toUpperCase(),\" \\u2022 \",(file.size/1024/1024).toFixed(1),\" MB\"]}),file.trackingId&&/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-500/20 text-red-400 border border-red-500/30\",children:\"\\uD83D\\uDD0F Tracked\"})]})]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>removeFile(index),className:\"p-1 text-slate-400 hover:text-red-400 hover:bg-red-500/10 rounded transition-colors\",title:\"Remove file\",children:/*#__PURE__*/_jsx(X,{className:\"h-4 w-4\"})})]},index);})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 flex justify-end\",children:/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmitPost,disabled:!hasContent||loading||isUploading,className:\"flex items-center justify-center space-x-2 px-6 py-3 rounded-lg transition-colors border-2 text-base font-semibold \".concat(hasContent&&!loading&&!isUploading?'bg-slate-700/60 text-slate-300 hover:bg-slate-700 border-amber-600/50 hover:border-amber-500 cursor-pointer':'bg-slate-700/30 text-slate-500 border-amber-600/30 cursor-not-allowed opacity-50'),children:/*#__PURE__*/_jsx(\"span\",{children:loading?'Posting...':isUploading?'Uploading...':'Post'})})}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 pt-2 border-t border-slate-600/30\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-wrap gap-2 justify-end\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{var _pdfInputRef$current;return(_pdfInputRef$current=pdfInputRef.current)===null||_pdfInputRef$current===void 0?void 0:_pdfInputRef$current.click();},disabled:isUploading,className:\"flex items-center space-x-2 px-3 py-2 rounded-lg transition-colors border-2 text-sm \".concat(isUploading?'bg-slate-700/20 text-slate-600 border-amber-600/20 cursor-not-allowed':'bg-slate-700/30 text-slate-500 border-amber-600/30 opacity-50 hover:opacity-70 hover:bg-slate-700/40 hover:text-slate-400'),title:\"PDF files up to \".concat(FILE_LIMITS.pdf.label,\" (with watermarking)\"),children:[/*#__PURE__*/_jsx(FileText,{className:\"h-4 w-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"PDF\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs opacity-70\",children:[\"(\",FILE_LIMITS.pdf.label,\")\"]}),/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-red-400\",children:\"\\uD83D\\uDD0F\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{var _audioInputRef$curren;return(_audioInputRef$curren=audioInputRef.current)===null||_audioInputRef$curren===void 0?void 0:_audioInputRef$curren.click();},disabled:isUploading,className:\"flex items-center space-x-2 px-3 py-2 rounded-lg transition-colors border-2 text-sm \".concat(isUploading?'bg-slate-700/20 text-slate-600 border-amber-600/20 cursor-not-allowed':'bg-slate-700/30 text-slate-500 border-amber-600/30 opacity-50 hover:opacity-70 hover:bg-slate-700/40 hover:text-slate-400'),title:\"Audio files up to \".concat(FILE_LIMITS.audio.label),children:[/*#__PURE__*/_jsx(Mic,{className:\"h-4 w-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Audio\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs opacity-70\",children:[\"(\",FILE_LIMITS.audio.label,\")\"]})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{var _videoInputRef$curren;return(_videoInputRef$curren=videoInputRef.current)===null||_videoInputRef$curren===void 0?void 0:_videoInputRef$curren.click();},disabled:isUploading,className:\"flex items-center space-x-2 px-3 py-2 rounded-lg transition-colors border-2 text-sm \".concat(isUploading?'bg-slate-700/20 text-slate-600 border-amber-600/20 cursor-not-allowed':'bg-slate-700/30 text-slate-500 border-amber-600/30 opacity-50 hover:opacity-70 hover:bg-slate-700/40 hover:text-slate-400'),title:\"Video files up to \".concat(FILE_LIMITS.video.label),children:[/*#__PURE__*/_jsx(Video,{className:\"h-4 w-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Video\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs opacity-70\",children:[\"(\",FILE_LIMITS.video.label,\")\"]})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>{var _photoInputRef$curren;return(_photoInputRef$curren=photoInputRef.current)===null||_photoInputRef$curren===void 0?void 0:_photoInputRef$curren.click();},disabled:isUploading,className:\"flex items-center space-x-2 px-3 py-2 rounded-lg transition-colors border-2 text-sm \".concat(isUploading?'bg-slate-700/20 text-slate-600 border-amber-600/20 cursor-not-allowed':'bg-slate-700/30 text-slate-500 border-amber-600/30 opacity-50 hover:opacity-70 hover:bg-slate-700/40 hover:text-slate-400'),title:\"Image files up to \".concat(FILE_LIMITS.image.label),children:[/*#__PURE__*/_jsx(Image,{className:\"h-4 w-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Photo\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs opacity-70\",children:[\"(\",FILE_LIMITS.image.label,\")\"]})]})]})})]})]}),/*#__PURE__*/_jsx(\"input\",{ref:pdfInputRef,type:\"file\",accept:\".pdf\",multiple:true,onChange:e=>{console.log('📁 PDF files selected:',e.target.files.length);handleFileSelect('pdf',e.target.files);},className:\"hidden\"}),/*#__PURE__*/_jsx(\"input\",{ref:audioInputRef,type:\"file\",accept:\"audio/*\",multiple:true,onChange:e=>{console.log('🎵 Audio files selected:',e.target.files.length);handleFileSelect('audio',e.target.files);},className:\"hidden\"}),/*#__PURE__*/_jsx(\"input\",{ref:videoInputRef,type:\"file\",accept:\"video/*\",multiple:true,onChange:e=>{console.log('📹 Video files selected:',e.target.files.length);handleFileSelect('video',e.target.files);},className:\"hidden\"}),/*#__PURE__*/_jsx(\"input\",{ref:photoInputRef,type:\"file\",accept:\"image/*\",multiple:true,onChange:e=>{console.log('📸 Photo files selected:',e.target.files.length);handleFileSelect('image',e.target.files);},className:\"hidden\"}),/*#__PURE__*/_jsx(\"input\",{ref:fileInputRef,type:\"file\",multiple:true,accept:\"image/*,video/*,audio/*,.pdf\",onChange:e=>uploadFiles(e.target.files),className:\"hidden\"})]});});// Enhanced Post component with improved PDF detection and tracking\nconst Post=/*#__PURE__*/React.memo(_ref6=>{var _post$likes,_post$likes2,_post$comments,_post$userId4,_post$userId4$usernam,_post$userId5,_post$userId6,_post$userId7,_user$username3;let{post,user,handleLike,handleComment,handleShare,isPublicView=false,onLoginPrompt,onPostClick,isDetailView=false,navigate}=_ref6;const[showComments,setShowComments]=useState(isDetailView);const[commentText,setCommentText]=useState('');const[showShareModal,setShowShareModal]=useState(false);const[showMoreMenu,setShowMoreMenu]=useState(false);const[showWhoLiked,setShowWhoLiked]=useState(false);const[isLiking,setIsLiking]=useState(false);const commentInputRef=useRef(null);const timestamp=getDetailedTimestamp(post.createdAt);// ENHANCED debugging for file detection\nuseEffect(()=>{if(post.mediaFiles&&post.mediaFiles.length>0){console.log('🔍 POST DEBUGGING - Post has media files:',post.mediaFiles);post.mediaFiles.forEach((file,index)=>{console.log(\"\\uD83D\\uDCC4 File \".concat(index,\" details:\"),{type:file.type,mimeType:file.mimeType,filename:file.filename,originalName:file.originalName,url:file.url,size:file.size,trackingId:file.trackingId,trackingUrl:file.trackingUrl,fullFile:file});});}},[post.mediaFiles]);// ✅ ENHANCED detectFileType function with better PDF detection\nconst detectFileType=file=>{console.log('🎯 Detecting file type for:',file);// ✅ ENHANCED PDF DETECTION - Check multiple criteria\nconst isPDF=file.type==='document'||file.type==='pdf'||file.mimeType==='application/pdf'||file.filename&&file.filename.toLowerCase().endsWith('.pdf')||file.originalName&&file.originalName.toLowerCase().endsWith('.pdf');console.log('📄 PDF detection result:',{isPDF,reasons:{typeIsDocument:file.type==='document',typeIsPdf:file.type==='pdf',mimeTypeIsPdf:file.mimeType==='application/pdf',filenameEndsPdf:file.filename&&file.filename.toLowerCase().endsWith('.pdf'),originalNameEndsPdf:file.originalName&&file.originalName.toLowerCase().endsWith('.pdf')},trackingId:file.trackingId,trackingUrl:file.trackingUrl});if(isPDF){return{category:'pdf',displayName:'PDF Document',icon:'📄',bgColor:'bg-red-500/20',textColor:'text-red-400',borderColor:'border-red-500/40',hoverBgColor:'hover:bg-red-500/30',hoverTextColor:'hover:text-red-300',hoverBorderColor:'hover:border-red-500/60',isTracked:!!file.trackingId};}// Image detection\nif(file.type==='image'||file.mimeType&&file.mimeType.startsWith('image/')){return{category:'image',displayName:'Image',icon:'🖼️',bgColor:'bg-blue-500/20',textColor:'text-blue-400',borderColor:'border-blue-500/40'};}// Video detection\nif(file.type==='video'||file.mimeType&&file.mimeType.startsWith('video/')){return{category:'video',displayName:'Video',icon:'🎬',bgColor:'bg-purple-500/20',textColor:'text-purple-400',borderColor:'border-purple-500/40'};}// Audio detection\nif(file.type==='audio'||file.mimeType&&file.mimeType.startsWith('audio/')){return{category:'audio',displayName:'Audio',icon:'🎵',bgColor:'bg-green-500/20',textColor:'text-green-400',borderColor:'border-green-500/40'};}// Default fallback\nconsole.warn('⚠️ Unknown file type, using default:',file);return{category:'document',displayName:'Document',icon:'📎',bgColor:'bg-orange-500/20',textColor:'text-orange-400',borderColor:'border-orange-500/40'};};const handleLikeClick=async()=>{if(isPublicView){onLoginPrompt===null||onLoginPrompt===void 0?void 0:onLoginPrompt();return;}setIsLiking(true);try{await handleLike(post._id);}finally{setTimeout(()=>setIsLiking(false),300);}};const handleCommentSubmit=()=>{if(!commentText.trim())return;if(isPublicView){onLoginPrompt===null||onLoginPrompt===void 0?void 0:onLoginPrompt();return;}handleComment===null||handleComment===void 0?void 0:handleComment(post._id,commentText);setCommentText('');};const handleShareClick=()=>{if(isPublicView){onLoginPrompt===null||onLoginPrompt===void 0?void 0:onLoginPrompt();return;}setShowShareModal(true);};const handleWhoLikedClick=()=>{if(isPublicView){onLoginPrompt===null||onLoginPrompt===void 0?void 0:onLoginPrompt();return;}setShowWhoLiked(true);};const handlePostContentClick=e=>{if(e.target.closest('button')||e.target.closest('input')||e.target.closest('a')||e.target.closest('.post-action-button')||showShareModal||showMoreMenu||showWhoLiked||isDetailView){return;}if(isPublicView){onLoginPrompt===null||onLoginPrompt===void 0?void 0:onLoginPrompt();return;}if(navigate){navigate(\"/post/\".concat(post._id));}onPostClick===null||onPostClick===void 0?void 0:onPostClick(post);};const isLiked=!isPublicView&&((_post$likes=post.likes)===null||_post$likes===void 0?void 0:_post$likes.some(like=>(typeof like==='string'?like:like.user||like._id)===((user===null||user===void 0?void 0:user._id)||(user===null||user===void 0?void 0:user.id))));const likeCount=((_post$likes2=post.likes)===null||_post$likes2===void 0?void 0:_post$likes2.length)||0;const commentCount=((_post$comments=post.comments)===null||_post$comments===void 0?void 0:_post$comments.length)||0;const usersWhoLiked=React.useMemo(()=>{if(!post.likes||post.likes.length===0)return[];return post.likes.map((like,index)=>{if(typeof like==='string'){return{_id:like,username:\"User \".concat(index+1),avatar:'👤',verified:false};}else if(like.user){return{_id:like.user._id||like.user,username:like.user.username||\"User \".concat(index+1),avatar:like.user.avatar||'👤',verified:like.user.verified||false};}else{return{_id:like._id||\"user-\".concat(index),username:like.username||\"User \".concat(index+1),avatar:like.avatar||'👤',verified:like.verified||false};}});},[post.likes]);// ✅ ENHANCED PDF click tracking\nconst handlePDFClick=async file=>{if(file.trackingId){try{const trackingUrl=file.trackingUrl||\"\".concat(API_BASE,\"/track/\").concat(file.trackingId);await fetch(trackingUrl,{method:'GET',headers:{'User-Agent':navigator.userAgent}});console.log('📊 PDF access tracked:',file.trackingId);}catch(error){console.error('Failed to track PDF access:',error);}}};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-r from-slate-900/40 to-zinc-900/40 backdrop-blur-md rounded-2xl p-6 border border-slate-600/30 mb-6 transition-all duration-300 group \".concat(!isDetailView&&!isPublicView?'hover:border-slate-500/50 cursor-pointer hover:bg-slate-800/30':''),onClick:handlePostContentClick,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start justify-between mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-start space-x-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-12 h-12 bg-gradient-to-r from-slate-600 to-zinc-600 rounded-full flex items-center justify-center text-white font-semibold text-sm shadow-lg\",children:((_post$userId4=post.userId)===null||_post$userId4===void 0?void 0:(_post$userId4$usernam=_post$userId4.username)===null||_post$userId4$usernam===void 0?void 0:_post$userId4$usernam.slice(0,2).toUpperCase())||'UN'}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2 mb-1\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-semibold text-white hover:text-slate-200 cursor-pointer\",children:((_post$userId5=post.userId)===null||_post$userId5===void 0?void 0:_post$userId5.username)||'Unknown User'}),((_post$userId6=post.userId)===null||_post$userId6===void 0?void 0:_post$userId6.verified)&&/*#__PURE__*/_jsx(\"div\",{className:\"w-5 h-5 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-white text-xs\",children:\"\\u2713\"})}),/*#__PURE__*/_jsx(\"span\",{className:\"text-slate-400 text-sm\",children:\"\\u2022\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-slate-400 text-sm hover:text-slate-300 cursor-pointer flex items-center space-x-1 group/timestamp\",title:timestamp.absolute,children:[/*#__PURE__*/_jsx(Clock,{className:\"h-3 w-3\"}),/*#__PURE__*/_jsx(\"span\",{className:\"group-hover/timestamp:hidden\",children:timestamp.relative}),/*#__PURE__*/_jsx(\"span\",{className:\"hidden group-hover/timestamp:inline text-xs\",children:timestamp.absolute})]})]}),((_post$userId7=post.userId)===null||_post$userId7===void 0?void 0:_post$userId7.transparencyScore)&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 bg-green-500 rounded-full\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs text-slate-500\",children:[post.userId.transparencyScore,\"% transparency\"]})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();setShowMoreMenu(!showMoreMenu);},className:\"p-2 text-slate-400 hover:text-white hover:bg-slate-700/50 rounded-lg transition-colors opacity-0 group-hover:opacity-100 post-action-button\",children:/*#__PURE__*/_jsx(MoreHorizontal,{className:\"h-5 w-5\"})}),showMoreMenu&&/*#__PURE__*/_jsxs(\"div\",{className:\"absolute right-0 top-10 bg-slate-800/90 backdrop-blur-md rounded-xl border border-slate-600/50 shadow-xl z-10 min-w-48\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:e=>{e.stopPropagation();navigator.clipboard.writeText(generatePostUrl(post._id));setShowMoreMenu(false);},className:\"w-full px-4 py-3 text-left text-slate-300 hover:text-white hover:bg-slate-700/50 rounded-t-xl transition-colors flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(Copy,{className:\"h-4 w-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Copy Link\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:e=>e.stopPropagation(),className:\"w-full px-4 py-3 text-left text-slate-300 hover:text-white hover:bg-slate-700/50 transition-colors flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(Bookmark,{className:\"h-4 w-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Save Post\"})]}),!isDetailView&&/*#__PURE__*/_jsxs(\"button\",{onClick:e=>{e.stopPropagation();if(navigate)navigate(\"/post/\".concat(post._id));onPostClick===null||onPostClick===void 0?void 0:onPostClick(post);setShowMoreMenu(false);},className:\"w-full px-4 py-3 text-left text-slate-300 hover:text-white hover:bg-slate-700/50 transition-colors flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(Eye,{className:\"h-4 w-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"View Post\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:e=>e.stopPropagation(),className:\"w-full px-4 py-3 text-left text-slate-300 hover:text-white hover:bg-slate-700/50 rounded-b-xl transition-colors flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(Flag,{className:\"h-4 w-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Report\"})]})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-4\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-slate-200 leading-relaxed whitespace-pre-wrap\",children:post.content})}),post.mediaFiles&&post.mediaFiles.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4 space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm text-slate-300 mb-3 flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xl\",children:\"\\uD83D\\uDCCE\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"font-medium\",children:[post.mediaFiles.length,\" attachment\",post.mediaFiles.length!==1?'s':'']}),/*#__PURE__*/_jsx(\"span\",{className:\"text-slate-500\",children:\"\\u2022 Click to download or view\"})]}),post.mediaFiles.map((file,idx)=>{const fileType=detectFileType(file);console.log(\"\\uD83C\\uDFA8 Rendering file \".concat(idx,\":\"),{file,fileType});return/*#__PURE__*/_jsxs(\"div\",{className:\"rounded-xl overflow-hidden border-2 \".concat(fileType.borderColor,\" \").concat(fileType.bgColor,\" p-1\"),children:[fileType.category==='image'&&/*#__PURE__*/_jsx(\"div\",{className:\"p-3\",children:/*#__PURE__*/_jsx(\"img\",{src:file.url,alt:\"Post media\",className:\"w-full h-auto max-h-96 object-cover hover:scale-105 transition-transform duration-300 cursor-pointer rounded-lg\",onClick:e=>e.stopPropagation(),onError:e=>{console.error('❌ Image failed to load:',file.url);e.target.style.display='none';}})}),fileType.category==='video'&&/*#__PURE__*/_jsx(\"div\",{className:\"p-3\",children:/*#__PURE__*/_jsx(EnhancedVideoPlayer,{file:file})}),fileType.category==='audio'&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 mb-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-12 h-12 \".concat(fileType.bgColor,\" rounded-lg flex items-center justify-center text-2xl border \").concat(fileType.borderColor),children:fileType.icon}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-medium\",children:file.filename||file.originalName||'Audio File'}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-slate-400 text-sm\",children:[fileType.displayName,\" \\u2022 \",(file.size/1024/1024).toFixed(1),\" MB\"]})]})]}),/*#__PURE__*/_jsxs(\"audio\",{controls:true,className:\"w-full\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(\"source\",{src:file.url}),\"Your browser does not support audio playback.\"]})]}),fileType.category==='pdf'&&/*#__PURE__*/_jsxs(\"div\",{className:\"p-5 \".concat(fileType.bgColor,\" rounded-xl\"),onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"w-16 h-16 \".concat(fileType.bgColor,\" rounded-xl flex items-center justify-center border-2 \").concat(fileType.borderColor,\" shadow-lg relative\"),children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-3xl\",children:fileType.icon}),fileType.isTracked&&/*#__PURE__*/_jsx(\"div\",{className:\"absolute -top-1 -right-1 w-4 h-4 bg-red-500 rounded-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-white text-xs\",children:\"\\uD83D\\uDD0F\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-white font-bold text-lg mb-1\",children:file.filename||file.originalName||'PDF Document'}),/*#__PURE__*/_jsxs(\"p\",{className:\"\".concat(fileType.textColor,\" text-sm font-medium mb-1 flex items-center space-x-2\"),children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"\\uD83D\\uDCC4 \",fileType.displayName]}),fileType.isTracked&&/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-500/20 text-red-400 border border-red-500/30\",children:\"\\uD83D\\uDD0F Watermarked & Tracked\"})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-slate-400 text-sm\",children:[(file.size/1024/1024).toFixed(1),\" MB\",file.mimeType&&\" \\u2022 \".concat(file.mimeType),file.trackingId&&/*#__PURE__*/_jsxs(\"span\",{className:\"block text-xs mt-1 text-red-400\",children:[\"Tracking ID: \",file.trackingId.substring(0,8),\"...\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col space-y-2\",children:[/*#__PURE__*/_jsxs(\"a\",{href:file.url,target:\"_blank\",rel:\"noopener noreferrer\",className:\"px-4 py-2 \".concat(fileType.bgColor,\" \").concat(fileType.hoverBgColor,\" \").concat(fileType.textColor,\" \").concat(fileType.hoverTextColor,\" rounded-lg transition-all duration-200 text-sm font-medium border-2 \").concat(fileType.borderColor,\" \").concat(fileType.hoverBorderColor,\" flex items-center space-x-2 hover:scale-105 transform\"),onClick:e=>{e.stopPropagation();handlePDFClick(file);console.log('🔗 Opening PDF:',file.url);},children:[/*#__PURE__*/_jsx(ExternalLink,{className:\"h-4 w-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"View PDF\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:e=>{e.stopPropagation();navigator.clipboard.writeText(file.url);console.log('📋 PDF URL copied:',file.url);},className:\"px-3 py-1 bg-slate-700/50 hover:bg-slate-700 text-slate-300 hover:text-white rounded-md transition-colors text-xs flex items-center space-x-1\",children:[/*#__PURE__*/_jsx(Copy,{className:\"h-3 w-3\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Copy Link\"})]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-3 pt-3 border-t border-red-500/20\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-slate-400 text-xs\",children:[\"\\uD83D\\uDCE5 Uploaded \",new Date(post.createdAt).toLocaleDateString(),\" \\u2022 Click \\\"View PDF\\\" to open in new tab\",fileType.isTracked&&/*#__PURE__*/_jsx(\"span\",{className:\"block mt-1 text-red-400\",children:\"\\uD83D\\uDD0F This PDF is watermarked and tracked for security purposes\"})]})})]}),fileType.category==='document'&&/*#__PURE__*/_jsx(\"div\",{className:\"p-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-12 h-12 \".concat(fileType.bgColor,\" rounded-lg flex items-center justify-center text-xl border \").concat(fileType.borderColor),children:fileType.icon}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-white font-medium\",children:file.filename||file.originalName||'Document'}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-slate-400 text-sm\",children:[fileType.displayName,\" \\u2022 \",(file.size/1024/1024).toFixed(1),\" MB\"]})]}),/*#__PURE__*/_jsx(\"a\",{href:file.url,target:\"_blank\",rel:\"noopener noreferrer\",className:\"px-3 py-2 \".concat(fileType.bgColor,\" hover:bg-orange-500/30 \").concat(fileType.textColor,\" hover:text-orange-300 rounded-lg transition-colors text-sm font-medium border \").concat(fileType.borderColor,\" hover:border-orange-500/50\"),onClick:e=>e.stopPropagation(),children:\"View File\"})]})})]},idx);})]}),(likeCount>0||commentCount>0)&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between text-slate-400 text-sm mb-3 pb-3 border-b border-slate-600/30\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[likeCount>0&&/*#__PURE__*/_jsxs(\"button\",{onClick:e=>{e.stopPropagation();handleWhoLikedClick();},className:\"flex items-center space-x-1 hover:text-slate-300 transition-colors cursor-pointer group post-action-button\",title:isPublicView?\"Sign up to see who liked this\":\"See who liked this post\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex -space-x-1\",children:/*#__PURE__*/_jsx(\"div\",{className:\"w-5 h-5 bg-gradient-to-r from-red-500 to-pink-500 rounded-full flex items-center justify-center border border-slate-800 group-hover:scale-110 transition-transform\",children:/*#__PURE__*/_jsx(Heart,{className:\"h-3 w-3 text-white\",fill:\"white\"})})}),/*#__PURE__*/_jsxs(\"span\",{className:\"hover:underline\",children:[likeCount,\" \",likeCount===1?'like':'likes']}),isPublicView&&/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-slate-500 ml-1\",children:\"\\uD83D\\uDD12\"})]}),commentCount>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-1\",children:[/*#__PURE__*/_jsx(Users,{className:\"h-4 w-4\"}),/*#__PURE__*/_jsxs(\"span\",{children:[commentCount,\" \",commentCount===1?'comment':'comments']})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-1\",children:[/*#__PURE__*/_jsx(Eye,{className:\"h-4 w-4\"}),/*#__PURE__*/_jsxs(\"span\",{children:[Math.floor(Math.random()*50)+20,\" views\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-1\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:e=>{e.stopPropagation();handleLikeClick();},className:\"flex items-center space-x-2 px-3 py-2 rounded-lg transition-all duration-200 post-action-button \".concat(isLiked?'text-red-400 bg-red-500/10 hover:bg-red-500/20':'text-slate-400 hover:text-red-400 hover:bg-red-500/10',\" \").concat(isLiking?'scale-110':''),title:isPublicView?\"Sign up to like posts\":\"Like this post\",children:[/*#__PURE__*/_jsx(Heart,{className:\"h-5 w-5 transition-all duration-200 \".concat(isLiking?'scale-125':''),fill:isLiked?'currentColor':'none'}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:likeCount||'Like'})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:e=>{e.stopPropagation();if(isPublicView){onLoginPrompt===null||onLoginPrompt===void 0?void 0:onLoginPrompt();}else{setShowComments(!showComments);setTimeout(()=>{var _commentInputRef$curr;return(_commentInputRef$curr=commentInputRef.current)===null||_commentInputRef$curr===void 0?void 0:_commentInputRef$curr.focus();},100);}},className:\"flex items-center space-x-2 px-3 py-2 rounded-lg text-slate-400 hover:text-indigo-400 hover:bg-indigo-500/10 transition-all duration-200 post-action-button\",title:isPublicView?\"Sign up to comment\":\"Comment on this post\",children:[/*#__PURE__*/_jsx(MessageCircle,{className:\"h-5 w-5\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:commentCount||'Comment'})]}),/*#__PURE__*/_jsx(\"div\",{className:\"relative\",children:/*#__PURE__*/_jsxs(\"button\",{onClick:e=>{e.stopPropagation();handleShareClick();},className:\"flex items-center space-x-2 px-3 py-2 rounded-lg text-slate-400 hover:text-green-400 hover:bg-green-500/10 transition-all duration-200 post-action-button\",title:isPublicView?\"Sign up to share\":\"Share this post\",children:[/*#__PURE__*/_jsx(Share2,{className:\"h-5 w-5\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Share\"})]})})]}),!isDetailView&&!isPublicView&&/*#__PURE__*/_jsxs(\"button\",{onClick:e=>{e.stopPropagation();if(navigate)navigate(\"/post/\".concat(post._id));onPostClick===null||onPostClick===void 0?void 0:onPostClick(post);},className:\"text-xs text-slate-500 hover:text-slate-400 transition-colors post-action-button flex items-center space-x-1\",children:[/*#__PURE__*/_jsx(Eye,{className:\"h-3 w-3\"}),/*#__PURE__*/_jsx(\"span\",{children:\"View Post\"})]}),isPublicView&&/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();onLoginPrompt();},className:\"text-xs text-slate-500 hover:text-slate-400 transition-colors post-action-button\",children:\"Join to interact \\u2192\"})]}),showComments&&!isPublicView&&/*#__PURE__*/_jsxs(\"div\",{className:\"mt-4 pt-4 border-t border-slate-600/30 space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 bg-gradient-to-r from-slate-600 to-zinc-600 rounded-full flex items-center justify-center text-white font-semibold text-xs\",children:(user===null||user===void 0?void 0:(_user$username3=user.username)===null||_user$username3===void 0?void 0:_user$username3.slice(0,2).toUpperCase())||'YU'}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-2\",children:[/*#__PURE__*/_jsx(\"input\",{ref:commentInputRef,type:\"text\",value:commentText,onChange:e=>setCommentText(e.target.value),onKeyPress:e=>e.key==='Enter'&&handleCommentSubmit(),onClick:e=>e.stopPropagation(),placeholder:\"Write a comment...\",className:\"flex-1 px-4 py-2 bg-black/40 border border-slate-600/50 rounded-full text-white placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-slate-400 focus:border-slate-400\"}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>{e.stopPropagation();handleCommentSubmit();},disabled:!commentText.trim(),className:\"px-4 py-2 bg-gradient-to-r from-slate-700 to-zinc-700 text-white rounded-full hover:scale-105 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed post-action-button\",children:/*#__PURE__*/_jsx(Send,{className:\"h-4 w-4\"})})]})})]}),post.comments&&post.comments.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:post.comments.map((comment,idx)=>{var _comment$user,_comment$user$usernam,_comment$author,_comment$user2;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 bg-gradient-to-r from-slate-600 to-zinc-600 rounded-full flex items-center justify-center text-white font-semibold text-xs\",children:((_comment$user=comment.user)===null||_comment$user===void 0?void 0:(_comment$user$usernam=_comment$user.username)===null||_comment$user$usernam===void 0?void 0:_comment$user$usernam.slice(0,2).toUpperCase())||((_comment$author=comment.author)===null||_comment$author===void 0?void 0:_comment$author.slice(0,2).toUpperCase())||'UN'}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bg-slate-800/50 rounded-2xl px-4 py-2\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2 mb-1\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-white text-sm\",children:((_comment$user2=comment.user)===null||_comment$user2===void 0?void 0:_comment$user2.username)||comment.author||'Unknown User'}),/*#__PURE__*/_jsx(\"span\",{className:\"text-slate-500 text-xs\",children:getDetailedTimestamp(comment.createdAt||new Date()).relative})]}),/*#__PURE__*/_jsx(\"p\",{className:\"text-slate-200 text-sm\",children:comment.content})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4 mt-1 px-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:e=>e.stopPropagation(),className:\"text-xs text-slate-500 hover:text-slate-400 transition-colors post-action-button\",children:\"Like\"}),/*#__PURE__*/_jsx(\"button\",{onClick:e=>e.stopPropagation(),className:\"text-xs text-slate-500 hover:text-slate-400 transition-colors post-action-button\",children:\"Reply\"})]})]})]},idx);})})]}),showMoreMenu&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 z-0\",onClick:e=>{e.stopPropagation();setShowMoreMenu(false);}})]}),/*#__PURE__*/_jsx(ShareModal,{post:post,isOpen:showShareModal,onClose:()=>setShowShareModal(false)}),showWhoLiked&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50\",onClick:()=>setShowWhoLiked(false),children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gradient-to-r from-slate-900/95 to-zinc-900/95 backdrop-blur-md rounded-2xl border border-slate-600/50 shadow-2xl max-w-md w-full mx-4 max-h-96 overflow-hidden\",onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between p-6 border-b border-slate-600/30\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-semibold text-white\",children:\"Liked by\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowWhoLiked(false),className:\"p-2 text-slate-400 hover:text-white hover:bg-slate-700/50 rounded-lg transition-colors\",children:/*#__PURE__*/_jsx(X,{className:\"h-5 w-5\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"p-4 overflow-y-auto max-h-80\",children:usersWhoLiked.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"text-center text-slate-400 py-8\",children:[/*#__PURE__*/_jsx(Heart,{className:\"h-12 w-12 mx-auto mb-3 opacity-50\"}),/*#__PURE__*/_jsx(\"p\",{children:\"No likes yet\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:usersWhoLiked.map((likeUser,index)=>{var _likeUser$username;return/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3 p-3 rounded-xl hover:bg-slate-800/30 transition-colors cursor-pointer\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-10 h-10 bg-gradient-to-r from-slate-600 to-zinc-600 rounded-full flex items-center justify-center text-white font-semibold text-sm shadow-lg\",children:((_likeUser$username=likeUser.username)===null||_likeUser$username===void 0?void 0:_likeUser$username.slice(0,2).toUpperCase())||likeUser.avatar||'👤'}),/*#__PURE__*/_jsx(\"div\",{className:\"flex-1\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-2\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium text-white\",children:likeUser.username}),likeUser.verified&&/*#__PURE__*/_jsx(\"div\",{className:\"w-4 h-4 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-white text-xs\",children:\"\\u2713\"})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"text-red-400\",children:/*#__PURE__*/_jsx(Heart,{className:\"h-5 w-5\",fill:\"currentColor\"})})]},index);})})})]})})]});});// The rest of the components (PostDetail, Feed, Profile, Chat, and Main App Component) remain the same\n// but would use the updated PostCreator and Post components above.\n// For brevity, I'll include just the key parts showing the updated file limits:\nconst SickoScoopApp=()=>{// ... [Keep all existing state and hooks] ...\n// Enhanced handlePost function with better debugging\nconst handlePost=async function(){var _user,_user2;let uploadedFiles=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];console.log('📝 handlePost called with:',{content:newPost,uploadedFiles:uploadedFiles,filesCount:uploadedFiles.length,hasContent:!!(newPost.trim()||uploadedFiles.length>0)});if(!newPost.trim()&&uploadedFiles.length===0){console.warn('⚠️ No content or files to post');return;}setLoading(true);// Process files properly\nconst processedFiles=uploadedFiles.map(file=>{console.log('🔍 Processing file for post:',file);return{type:file.type,url:file.url,thumbnailUrl:file.thumbnailUrl,filename:file.filename||file.originalName,originalName:file.originalName||file.filename,size:file.size,mimeType:file.mimeType,spacesKey:file.spacesKey,isOptimized:file.isOptimized||false,trackingId:file.trackingId,// ✅ Include tracking ID\ntrackingUrl:file.trackingUrl// ✅ Include tracking URL\n};});console.log('📁 Processed files for post:',processedFiles);const newPostData={_id:Date.now().toString(),userId:{username:((_user=user)===null||_user===void 0?void 0:_user.username)||'You',verified:true,_id:((_user2=user)===null||_user2===void 0?void 0:_user2._id)||'demo-user'},content:newPost,mediaFiles:processedFiles,likes:[],comments:[],createdAt:new Date()};console.log('📄 Complete post data:',newPostData);try{if(apiStatus==='connected'&&token!=='demo-token'){console.log('🌐 Sending post to backend API...');const postPayload={content:newPost,mediaFiles:processedFiles};console.log('📤 API payload:',postPayload);const response=await apiCall('/posts',{method:'POST',body:JSON.stringify(postPayload)},token);console.log('✅ Backend response:',response);if(response._id||response.id){console.log('📄 Post created successfully with ID:',response._id||response.id);const responseWithFiles=_objectSpread(_objectSpread({},response),{},{mediaFiles:response.mediaFiles||processedFiles});console.log('📄 Final post data:',responseWithFiles);const updatedAllPosts=[responseWithFiles,...allPosts];setAllPosts(updatedAllPosts);updateDisplayedPosts(updatedAllPosts,feedType,user);}else{console.error('❌ Invalid post response from backend:',response);throw new Error('Invalid post response');}}else{console.log('🔧 Using demo mode - adding post locally');console.log('📄 Demo post data:',newPostData);const updatedAllPosts=[newPostData,...allPosts];setAllPosts(updatedAllPosts);updateDisplayedPosts(updatedAllPosts,feedType,user);}console.log('✅ Post creation completed successfully');setNewPost('');return true;}catch(error){console.error('❌ Post creation error:',error);console.log('🔧 Falling back to demo mode due to error');const updatedAllPosts=[newPostData,...allPosts];setAllPosts(updatedAllPosts);updateDisplayedPosts(updatedAllPosts,feedType,user);setNewPost('');return true;}finally{setLoading(false);}};// ... [Keep all other existing functions and return statement] ...\nreturn{/* Keep existing JSX structure */};};export default SickoScoopApp;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}